<!DOCTYPE html>
<html>
<head>
<title>Kala Residency Payment Form</title>
<style>
body {
  font-family: Arial;
  padding: 20px;
  background: #f5f5f5;
}
form {
  background: white;
  padding: 20px;
  border-radius: 10px;
  width: 350px;
  margin: auto;
  box-shadow: 0 0 10px #ccc;
}
label { font-weight: bold; }
input, select {
  width: 100%;
  padding: 8px;
  margin-bottom: 12px;
  border-radius: 5px;
  border: 1px solid #ccc;
}
button {
  width: 100%;
  padding: 10px;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
  font-size: 16px;
}
</style>
</head>
<body>

<h2 style="text-align:center;">Kala Residency Payment</h2>

<form id="payForm">

<label>Flat No</label>
<select id="flat" required>
  <option value="">Select</option>
  <!-- Flat No 1 to 21 -->
  <script>
    for (let i = 1; i <= 21; i++) {
      document.write(`<option value="Flat ${i}">Flat ${i}</option>`);
    }
  </script>
  <!-- Shop No 1 to 5 -->
  <script>
    for (let i = 1; i <= 5; i++) {
      document.write(`<option value="Shop ${i}">Shop ${i}</option>`);
    }
  </script>
</select>

<label>Owner / Tenant</label>
<select id="type" required>
  <option value="Owner">Owner</option>
  <option value="Tenant">Tenant</option>
</select>

<label>Name</label>
<input type="text" id="name" required>

<label>Month</label>
<input type="month" id="month" required>

<label>Amount (₹)</label>
<input type="number" id="amount" required>

<label>Purpose</label>
<select id="purpose" required>
  <option value="Maintenance">Maintenance</option>
  <option value="Water Charges">Water Charges</option>
  <option value="Parking">Parking</option>
  <option value="Sinking Fund">Sinking Fund</option>
  <option value="Other">Other</option>
</select>

<label>Remark (Optional)</label>
<input type="text" id="remark">

<button type="submit">Submit & Pay</button>

</form>

<script>
document.getElementById("payForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const data = {
    flat: document.getElementById("flat").value,
    type: document.getElementById("type").value,
    name: document.getElementById("name").value,
    month: document.getElementById("month").value,
    amount: document.getElementById("amount").value,
    purpose: document.getElementById("purpose").value,
    remark: document.getElementById("remark").value
  };

  // SAVE TO GOOGLE SHEET
  await fetch("https://script.google.com/macros/s/AKfycbwhPuy5qmFWA4nc_m6D5sgsfBmXavpGvdVEOW5jBoyAWdskiIQ9tKDnQaIh79CWl5B8/exec", {
    method: "POST",
    body: JSON.stringify(data)
  });

  // Memo Format:
  // Flat No: FLAT — NAME — MONTH — PURPOSE
  const memo = `Flat No: ${data.flat} — ${data.name} — ${data.month} — ${data.purpose}`;

  // Auto-Redirect UPI Link
  const upi = 
    `upi://pay?pa=9766893279@kotak811&pn=Devendra%20Kapoore&cu=INR&am=${data.amount}&tn=${encodeURIComponent(memo)}`;

  window.location.href = upi;
});
</script>

</body>
</html>
